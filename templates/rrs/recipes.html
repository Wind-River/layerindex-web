{% extends "rrs/base_toplevel.html" %}
{% load i18n %}
{% load staticfiles %}

{% load url from future %}

{% comment %}

  rrs-web - top level page template

  Copyright (C) 2015 Intel Corporation
  Licensed under the MIT license, see COPYING.MIT for details

{% endcomment %}

{% block navs %}
{% endblock %}

{% block content_inner %}
<div class="navbar navbar-table-controls">
    <div class="navbar-inner table-controls">
        <ul class="nav">
            <li class="dropdown">
                <span class="badge">{{ recipe_list_count }} recipes</span>
            </li>
            <li class="dropdown">
                <a data-toggle="dropdown" href="#" class="dropdown-toggle" id="selected-status">
                    Upstream status: <strong>{{ upstream_status }}</strong>
                    <b class="caret"></b>
                </a>
                <ul class="dropdown-menu" id="select-status">
                    {% for us in all_upstream_status %}
                    {% if us = upstream_status %}
                    <li class="active">
                    <a href="#">
                    {% else %}
                    <li>
                    <a href="{% url this_url_name milestone_name %}?upstream_status={{ us|urlencode }}&maintainer_name={{ maintainer_name|urlencode }}">
                    {% endif %}

                    {{ us }}
                    </a>
                    </li>
                    {% endfor %}
                </ul>
            </li>
            <li><p>and</p></li>
            <li class="dropdown">
                <a data-toggle="dropdown" href="#" class="dropdown-toggle" id="select-maintainer">
                    Maintainer: <strong>{{ maintainer_name }}</strong>
                    <b class="caret"></b>
                </a>
                <ul class="dropdown-menu" id="selected-maintainer">
                    {% for m in all_maintainers %}
                    {% if m = maintainer_name %}
                    <li class="active">
                    <a href="#">
                    {% else %}
                    <li>
                    <a href="{% url this_url_name milestone_name %}?upstream_status={{ upstream_status|urlencode }}&maintainer_name={{ m|urlencode }}">
                    {% endif %}

                    {{ m }}</a>

                    </li>
                    {% endfor %}
                </ul>
            </li>
        </ul>

        <form class="navbar-form pull-right">
            <input type="text" class="input-xxlarge" placeholder="Search all recipes" id="filter"/>                
        </form>
    </div>
</div>

<table class="table table-bordered tablesorter table-hover recipestable">
<thead>
    <tr>
        <th class="recipe_column">Recipe</th>
        <th class="version_column muted">Version</th>
        <th class="upstream_status_column"><b>Upstream status</b></th>
        <th class="upstream_version_column muted">Upstream version</th>
        <th class="maintainer_column"><b>Maintainer</b></th>
        <th class="summary_column muted span5">Summary</th>
    </tr>
    </thead>
<tbody>
{% for r in recipe_list %}
<tr>
    <td class="recipe_column"><a href="{% url "recipedetail" r.pk %}">{{ r.name }}</a></td>
    <td class="version_column">{{ r.version }}</td>
    {% if r.upstream_status == "Up-to-date" %}
    <td class="text-success">
    {% elif r.upstream_status == "Not updated" %}
    <td class="text-error">
    {% else %}
    <td class="text-warning">
    {% endif %}
        {{ r.upstream_status }}
    </td>
    <td class="upstream_version_column">{{ r.upstream_version }}</td>
    <td class="maintainer_column">{{ r.maintainer_name }}</td>
    <td class="summary_column">{{ r.summary }}</td>
</tr>
{% endfor %}
</tbody>
</table>
{% endblock %}

{% block scripts %}
<script src="{% static "js/uitablefilter.js" %}"></script>
<script>
$(document).ready(function() {
    $("#filter").keyup(function() { 
        var recipestable = $('.recipestable');
        $.uiTableFilter(recipestable, this.value);
    });
});
</script>
{% endblock %}
